<h3>New Link</h3>
<%= form_for :link do |f| %>
  <%= f.text_field :title %>
  <%= f.text_field :url %>
  <%= f.submit 'Submit' %>
<% end %>

<div>
  <h3>Links</h3>
  <ul>
  </ul>
</div>

<script>
  var fetchLinks = function(url) {
    $.get(url, function (data) {
      data.forEach(function (link) {
        var title, url, buttonText, form, editLink;
        var csrf = $("meta[name=csrf-token]").attr("content");
        var li = $("<li></li>");

        if (link.read) {
          title = $("<h4><s>" + link.title + "</s><h4>");
          url   = $("<h5><s>" + link.url   + "</s></h5>");
          buttonText = "Mark as Unread"
        } else {
          title = $("<h4>" + link.title + "<h4>");
          url   = $("<h5>" + link.url   + "</h5>");
          buttonText = "Mark as Read"
        }

        form = '<form class="button_to" method="post" action="/links/' + link.id + '/change_status">' +
          '<input type="submit" value="' + buttonText + '">' +
          '<input type="hidden" name="authenticity_token" value="' + csrf + '">' +
          '</form>';

        editLink = $('<a href="/links/' + link.id + '/edit">Edit</a>');
        li.append(title).append(url).append(form).append(editLink);
        $('ul').append(li);

      })
    })
  };

  fetchLinks('/api/v1/links')
</script>